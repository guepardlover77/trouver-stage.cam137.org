const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./export-AiKJFuQl.js","./leaflet-C4iS2aBk.js"])))=>i.map(i=>d[i]);
import{_ as p}from"./export-AiKJFuQl.js";import{s as u,g as m,f as g}from"./main-R0kCeu9K.js";import"./leaflet-C4iS2aBk.js";let d=null,f=null;async function y(){if(!d){const t=await p(()=>import("./export-AiKJFuQl.js").then(o=>o.b),__vite__mapDeps([0,1]),import.meta.url);d=t.default||t.jsPDF,f=(await p(()=>import("./export-AiKJFuQl.js").then(o=>o.j),__vite__mapDeps([0,1]),import.meta.url)).default}return{jsPDF:d,autoTable:f}}function x(t,i){const o=["Nom","Adresse","Code Postal","Ville","Type","Niveau","Téléphone","Contact","Email","Commentaire","Latitude","Longitude"],s=t.map(n=>{var c,a;return[l(n.nom),l(n.adresse),n.codePostal,l(n.ville),l(n.type),n.niveau,n.telephone,l(n.contact),n.email,l(n.commentaire),((c=n.lat)==null?void 0:c.toString())||"",((a=n.lon)==null?void 0:a.toString())||""]}),e="\uFEFF"+[o.join(";"),...s.map(n=>n.join(";"))].join(`
`);h(e,m("lieux-stage","csv"),"text/csv;charset=utf-8")}function l(t){return t?t.includes('"')||t.includes(";")||t.includes(`
`)?`"${t.replace(/"/g,'""')}"`:t:""}function b(t,i){const o=JSON.stringify(t,null,2);h(o,m("lieux-stage","json"),"application/json")}async function F(t,i={}){const{jsPDF:o}=await y(),{title:s="Liste des Lieux de Stage",filename:r=m("lieux-stage","pdf")}=i,e=new o({orientation:"landscape",unit:"mm",format:"a4"});e.setFontSize(16),e.setFont("helvetica","bold"),e.text(s,14,15),e.setFontSize(10),e.setFont("helvetica","normal"),e.text(`Export du ${g()}`,14,22),e.text(`${t.length} établissement(s)`,14,27);const n=t.map(a=>[a.nom||"",a.adresse||"",`${a.codePostal} ${a.ville}`,a.type||"",a.niveau||"",a.telephone||"",a.contact||""]);e.autoTable({startY:32,head:[["Nom","Adresse","Ville","Type","Niveau","Téléphone","Contact"]],body:n,styles:{fontSize:8,cellPadding:2},headStyles:{fillColor:[37,99,235],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[248,250,252]},columnStyles:{0:{cellWidth:45},1:{cellWidth:50},2:{cellWidth:35},3:{cellWidth:35},4:{cellWidth:15},5:{cellWidth:30},6:{cellWidth:35}}});const c=e.getNumberOfPages();for(let a=1;a<=c;a++)e.setPage(a),e.setFontSize(8),e.setTextColor(128),e.text(`Page ${a} / ${c}`,e.internal.pageSize.width-20,e.internal.pageSize.height-10);e.save(r)}function h(t,i,o){const s=new Blob([t],{type:o}),r=URL.createObjectURL(s),e=document.createElement("a");e.href=r,e.download=i,e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e),URL.revokeObjectURL(r)}async function v(t){const i=t.map(o=>u.locations[o]).filter(Boolean);x(i)}async function T(t){const i=t.map(o=>u.locations[o]).filter(Boolean);b(i)}async function j(t){const i=t.map(o=>u.locations[o]).filter(Boolean);await F(i)}export{v as exportAsCsv,T as exportAsJson,j as exportAsPdf,x as exportToCSV,b as exportToJSON,F as exportToPDF};
//# sourceMappingURL=export.service-B5insj9F.js.map
